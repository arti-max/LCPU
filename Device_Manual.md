# LCPU Device Development Documentation

## Введение

Эта документация предназначена для разработчиков, которые хотят создавать устройства для LCPU. Вы узнаете, как объявлять устройства, подключать их к API и использовать основные функции.

## Объявление устройства

Чтобы создать устройство, выполните следующие шаги:

1. **Создайте файл устройства**: Создайте файл с расширением `.py`, например `my_device.py`.
2. **Импортируйте необходимые модули**: Убедитесь, что вы импортировали необходимые модули из `api.device`.

Пример:

```python
from api.device import Device

class MyDevice(Device):
    def __init__(self):
        super().__init__()
        # Инициализация устройства
```

## Основные методы устройства

Ваше устройство должно реализовывать следующие методы:

- `init()`: Метод для инициализации устройства. Здесь вы можете установить начальные параметры и подготовить устройство к работе.
- `update()`: Метод для обновления состояния устройства. Этот метод будет вызываться в основном цикле программы для обновления состояния устройства.
- `draw()`: Метод для отрисовки устройства на экране. Используйте Pygame для визуализации вашего устройства.
- `IN()`: Метод для обработки входных данных от устройства.
- `OUT()`: Метод для обработки выходных данных от устройства.

### Пример реализации устройства

```python
from api.device import Device

class LED(Device):
    def __init__(self):
        super().__init__()
        self.state = False  # Состояние светодиода

    def init(self):
        # Инициализация светодиода
        print("LED initialized")

    def update(self):
        # Обновление состояния светодиода
        if self.state:
            print("LED is ON")
        else:
            print("LED is OFF")

    def draw(self, surface):
        # Отрисовка светодиода на экране
        color = (255, 255, 0) if self.state else (0, 0, 0)
        pygame.draw.circle(surface, color, (50, 50), 20)  # Рисуем круг

    def IN(self, value):
        # Обработка входных данных
        self.state = bool(value)

    def OUT(self):
        # Возврат состояния
        return self.state
```

## Конфигурация устройства

Каждое устройство имеет свой конфигурационный файл, который хранится в директории `ino/conf`. Этот файл содержит параметры, необходимые для инициализации устройства.

Пример конфигурационного файла `led.cfg`:

```json
{
    "pin": 13,
    "brightness": 255
}
```

## Загрузка устройств

Все устройства загружаются из директории `ino/devices`. Убедитесь, что ваши устройства правильно объявлены и имеют соответствующие конфигурационные файлы.

### Пример загрузки устройств

В файле `ports.json` вы можете указать, какие устройства подключить:

```json
{
    "0": "led.py",
    "1": "button.py"
}
```

## Обработчики событий

Вы можете назначать обработчики событий для ваших устройств. Например, для кнопки можно назначить обработчик нажатия:

```python
def handle_button_press(self):
    print("Button pressed!")
```

## Заключение

Теперь вы знаете, как создавать устройства для LCPU. Следуйте этой документации, чтобы интегрировать свои устройства и использовать их в проектах! Если у вас есть вопросы, обратитесь к документации по ассемблеру и основному руководству пользователя.
